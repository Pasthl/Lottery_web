<!-- index.ejs - 抽奖系统主页 -->  

<!-- 页面标题部分 --> 
<div class="main-header">     
    <h1>这是一个很正经的抽奖网站</h1>     
    <p class="subtitle">这是抽奖网站的主页面</p> 
</div>  

<!-- 活动信息部分 --> 
<section class="lottery-info">     
    <div class="card">         
        <h2>当前抽奖活动</h2>         
        <% if (typeof currentLottery !== 'undefined' && currentLottery) { %>
            <!-- 数据库中的抽奖活动 -->
            <div class="lottery-details">             
                <h3><%= currentLottery.title %></h3>             
                <p><%= currentLottery.description %></p>                          
                <!-- 倒计时区域 -->             
                <div class="countdown">                 
                    <h4>距离开奖还有：</h4>                 
                    <div class="timer" id="countdown-timer" data-end="<%= currentLottery.endTime.getTime() %>">                     
                        <span id="days">00</span>天                     
                        <span id="hours">00</span>时                     
                        <span id="minutes">00</span>分                     
                        <span id="seconds">00</span>秒                 
                    </div>             
                </div>         
            </div>
        <% } else { %>
            <!-- 如果没有抽奖活动，显示静态内容 -->
            <div class="lottery-details">             
                <h3>比如这是一张月卡</h3>             
                <p>由沦宝姐姐友情赞助</p>                          
                <!-- 倒计时区域 -->             
                <div class="countdown">                 
                    <h4>距离开奖还有：</h4>                 
                    <div class="timer" id="countdown-timer">                     
                        <span id="days">00</span>天                     
                        <span id="hours">00</span>时                     
                        <span id="minutes">00</span>分                     
                        <span id="seconds">00</span>秒                 
                    </div>             
                </div>         
            </div>
        <% } %>
    </div> 
</section>  

<!-- 上一期中奖名单部分 --> 
<section class="winners-section">     
    <div class="card">         
        <h2>上一期中奖名单</h2>         
        <% if (typeof winners !== 'undefined' && winners && winners.length > 0) { %>
            <!-- 数据库中的中奖者 -->
            <ul class="winners-list">
                <% winners.forEach(function(winner) { %>
                    <li>                 
                        <span class="winner-id">用户ID: <%= winner.participantId %></span>                 
                        <span class="winner-date">抽奖日期: <%= winner.reviewedAt ? new Date(winner.reviewedAt).toLocaleDateString() : '未知' %></span>             
                    </li>
                <% }); %>
            </ul>
        <% } else { %>
            <!-- 静态示例数据 -->         
            <ul class="winners-list">             
                <li>                 
                    <span class="winner-id">用户ID: 白猫警司</span>                 
                    <span class="winner-date">抽奖日期: 2025-02-14</span>             
                </li>             
                <li>                 
                    <span class="winner-id">用户ID: 黑猫警督</span>                 
                    <span class="winner-date">抽奖日期: 2025-02-14</span>             
                </li>         
            </ul>
        <% } %>
    </div> 
</section>  

<!-- 参与抽奖表单部分 --> 
<section class="entry-form">     
    <div class="card">         
        <h2>参与本期抽奖</h2>         
        
        <% if (typeof currentLottery !== 'undefined' && currentLottery) { %>
            <!-- 表单提交到/submit路由 -->         
            <form id="lottery-form" action="/submit" method="post" enctype="multipart/form-data">             
                <!-- 显示成功消息 -->
                <% if (typeof success !== 'undefined' && success === 'true') { %>
                    <div class="success-message">
                        提交成功！您的抽奖条目已记录，请等待审核。
                    </div>
                <% } %>
                
                <!-- 显示错误消息 -->
                <% if (typeof error !== 'undefined' && error) { %>
                    <div class="error-message">
                        <%= error %>
                    </div>
                <% } %>
                
                <!-- 隐藏的抽奖活动ID -->
                <input type="hidden" name="lotteryId" value="<%= currentLottery._id %>">
                
                <!-- 参与者ID输入框 -->             
                <div class="form-group">                 
                    <label for="participant-id">请输入你的燕云id</label>                 
                    <input type="text" id="participant-id" name="participantId" required>                 
                    <small>不准乱输，违者失去当次抽奖资格并奖励雁雁的一个大比斗</small>             
                </div>                          
                
                <!-- 截图上传 -->             
                <div class="form-group">                 
                    <label for="screenshot">上传截图：</label>                 
                    <input type="file" id="screenshot" name="screenshot" accept="image/*" required>                 
                    <small>上传百业活跃度截图</small>             
                </div>                          
                
                <!-- 提交按钮 -->             
                <button type="submit" class="btn">提交参与</button>         
            </form>
        <% } else { %>
            <!-- 如果没有进行中的抽奖活动 -->
            <form id="lottery-form" action="/submit" method="post" enctype="multipart/form-data">             
                <!-- 参与者ID输入框 -->             
                <div class="form-group">                 
                    <label for="participant-id">请输入你的燕云id</label>                 
                    <input type="text" id="participant-id" name="participantId" required>                 
                    <small>不准乱输，违者失去当次抽奖资格并奖励雁雁的一个大比斗</small>             
                </div>                          
                
                <!-- 截图上传 -->             
                <div class="form-group">                 
                    <label for="screenshot">上传截图：</label>                 
                    <input type="file" id="screenshot" name="screenshot" accept="image/*" required>                 
                    <small>上传百业活跃度截图</small>             
                </div>                          
                
                <!-- 提交按钮 -->             
                <button type="submit" class="btn">提交参与</button>         
            </form>
        <% } %>
    </div> 
</section>  

<!-- 管理员入口链接 --> 
<div class="admin-link">     
    <a href="/admin">进入管理员页面</a> 
</div>  

<div class="easter-egg-link">     
    <a href="/easter-egg" title="点击查看彩蛋">🥚 发现彩蛋!</a> 
</div>